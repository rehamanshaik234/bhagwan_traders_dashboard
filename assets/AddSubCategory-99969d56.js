import{r as s,j as r,C as S,S as v}from"./index-6881a38b.js";import{B}from"./Breadcrumb-463c378a.js";import{u as k,c as _,a as u,d as w}from"./array-502ce756.js";import{u as A}from"./useSubCategory-fb623db8.js";import{u as T}from"./useCategory-d265f006.js";import{T as x,B as q}from"./Box-d449a0b0.js";import{G as a}from"./Grid-132cce37.js";import{T as p}from"./TextField-7f727abd.js";import{M as F}from"./MenuItem-0a5cd614.js";import{A as D}from"./Avatar-963f1f93.js";import{B as g}from"./Button-ff562e0b.js";import{C as I}from"./CircularProgress-8429f72f.js";import"./index.esm-522351cb.js";import"./Link-585f2144.js";import"./_baseIsEqual-f6d5b41e.js";import"./FormControl-8f5e2d3c.js";import"./utils-a73c94d0.js";import"./useFormControl-d4f0b139.js";import"./isMuiElement-4897e4b7.js";import"./useId-c7e897e5.js";import"./formControlState-a1fb9590.js";import"./Select-d12d8e0d.js";import"./Popover-40bbd40c.js";import"./Modal-04cf2a2a.js";import"./Fade-577ca4d2.js";import"./ownerWindow-71250041.js";import"./createChainedFunction-0bab83cf.js";import"./Portal-343632f1.js";import"./List-9cc45e96.js";import"./useControlled-4f8eaaf0.js";import"./listItemTextClasses-0a907018.js";import"./dividerClasses-f2209139.js";const z=[{to:"/",title:"Home"},{to:"/allSubCategories",title:"Sub Categories"},{title:"Add Sub Category"}],pe=()=>{const{addSubCategory:b}=A(),{getAllCategories:C}=T(),[y,j]=s.useState([]),[l,n]=s.useState({open:!1,message:""}),[d,h]=s.useState(!1),[f,m]=s.useState(null);s.useEffect(()=>{(async()=>{const o=await C();o!=null&&o.status&&j(o.data)})()},[]);const e=k({initialValues:{name:"",description:"",category_id:"",file:null},validationSchema:_({name:u().required("Name is required"),description:u().required("Description is required"),category_id:u().required("Category is required"),file:w().required("Image is required")}),onSubmit:async(t,{resetForm:o})=>{try{h(!0);const i=new FormData;i.append("name",t.name),i.append("description",t.description),i.append("category_id",t.category_id),i.append("file",t.file);const c=await b(i);c.status?(n({open:!0,message:c.message}),o(),m(null)):n({open:!0,message:c.error||"Error occurred"})}catch(i){n({open:!0,message:i.message||"Error occurred"})}finally{h(!1)}}});return r.jsxs(r.Fragment,{children:[r.jsx(B,{title:"Add Sub Category",items:z}),r.jsxs(S,{elevation:4,sx:{p:4,mx:"auto",borderRadius:3,backgroundColor:"#fff"},children:[r.jsx(x,{variant:"h5",fontWeight:600,gutterBottom:!0,children:"Add Sub Category"}),r.jsx("form",{onSubmit:e.handleSubmit,encType:"multipart/form-data",children:r.jsxs(a,{container:!0,spacing:3,children:[r.jsx(a,{item:!0,xs:12,sm:6,children:r.jsx(p,{fullWidth:!0,label:"Name",name:"name",variant:"outlined",value:e.values.name,onChange:e.handleChange,onBlur:e.handleBlur,error:e.touched.name&&!!e.errors.name,helperText:e.touched.name&&e.errors.name})}),r.jsx(a,{item:!0,xs:12,sm:6,children:r.jsx(p,{fullWidth:!0,select:!0,label:"Select Category",name:"category_id",value:e.values.category_id,onChange:e.handleChange,onBlur:e.handleBlur,error:e.touched.category_id&&!!e.errors.category_id,helperText:e.touched.category_id&&e.errors.category_id,children:y.map(t=>r.jsx(F,{value:t.id,children:t.name},t.id))})}),r.jsx(a,{item:!0,xs:12,children:r.jsx(p,{fullWidth:!0,multiline:!0,rows:3,label:"Description",name:"description",variant:"outlined",value:e.values.description,onChange:e.handleChange,onBlur:e.handleBlur,error:e.touched.description&&!!e.errors.description,helperText:e.touched.description&&e.errors.description})}),f&&r.jsx(a,{item:!0,xs:12,children:r.jsxs(q,{mt:1,position:"relative",display:"inline-block",children:[r.jsx(D,{src:f,alt:"Preview",variant:"rounded",sx:{width:120,height:120,border:"1px solid #ccc"}}),r.jsx(g,{size:"small",onClick:()=>{m(null),e.setFieldValue("file",null)},sx:{minWidth:0,padding:0,position:"absolute",top:-8,right:-8,backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"50%",zIndex:2,lineHeight:1},children:"âœ•"})]})}),r.jsxs(a,{item:!0,xs:12,children:[r.jsxs(g,{variant:"outlined",component:"label",sx:{":hover":{backgroundColor:"#b9b9b9ff",borderColor:"#b9b9b9ff"}},children:["Upload Image",r.jsx("input",{hidden:!0,type:"file",name:"file",accept:"image/*",onChange:t=>{const o=t.currentTarget.files[0];if(e.setFieldValue("file",o),o){const i=new FileReader;i.onloadend=()=>m(i.result),i.readAsDataURL(o)}}})]}),e.touched.file&&e.errors.file&&r.jsx(x,{variant:"caption",color:"error",sx:{mt:1,display:"block"},children:e.errors.file})]}),r.jsx(a,{item:!0,xs:12,children:r.jsx(g,{type:"submit",variant:"contained",size:"large",disabled:d,startIcon:d&&r.jsx(I,{size:20}),children:d?"Submitting...":"Add Sub Category"})})]})})]}),r.jsx(v,{open:l.open,autoHideDuration:3e3,onClose:()=>n({...l,open:!1}),message:l.message,anchorOrigin:{vertical:"bottom",horizontal:"right"}})]})};export{pe as default};
