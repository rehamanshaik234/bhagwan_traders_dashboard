import{r as a,j as e,C as F,S as H,D as O}from"./index-6881a38b.js";import{B as W}from"./Breadcrumb-463c378a.js";import{u as L}from"./useInventory-26d185b2.js";import{B as P}from"./Box-d449a0b0.js";import{T as v}from"./TextField-7f727abd.js";import{T as Q,a as q,b as y,c as s,d as G}from"./TableRow-d0664d59.js";import{C as J}from"./Chip-800657f9.js";import{B as h}from"./Button-ff562e0b.js";import{T as K}from"./TablePagination-5840844c.js";import{D as M,a as V}from"./DialogContent-f1adb223.js";import{D as X}from"./DialogTitle-7dff730c.js";import{D as Y}from"./DialogActions-bbf09e0d.js";import{C as Z}from"./CircularProgress-8429f72f.js";import"./index.esm-522351cb.js";import"./Grid-132cce37.js";import"./Link-585f2144.js";import"./FormControl-8f5e2d3c.js";import"./utils-a73c94d0.js";import"./useFormControl-d4f0b139.js";import"./isMuiElement-4897e4b7.js";import"./useId-c7e897e5.js";import"./formControlState-a1fb9590.js";import"./Select-d12d8e0d.js";import"./Popover-40bbd40c.js";import"./Modal-04cf2a2a.js";import"./Fade-577ca4d2.js";import"./ownerWindow-71250041.js";import"./createChainedFunction-0bab83cf.js";import"./Portal-343632f1.js";import"./List-9cc45e96.js";import"./useControlled-4f8eaaf0.js";import"./KeyboardArrowRight-b6f9714b.js";import"./Toolbar-f3beb080.js";import"./MenuItem-0a5cd614.js";import"./listItemTextClasses-0a907018.js";import"./dividerClasses-f2209139.js";const $=[{to:"/",title:"Home"},{title:"Update Stock"}],Re=()=>{const{getProducts:x,products:f,updateStock:k,categories:w,getCategories:D,brands:T,getBrands:B}=L(),[n,U]=a.useState(""),[g,z]=a.useState([]),[A,E]=a.useState(null),[j,b]=a.useState(""),[I,l]=a.useState(!1),[o,i]=a.useState({open:!1,message:"",type:"success"}),[c,S]=a.useState(!1),[m,C]=a.useState(0),[d,N]=a.useState(5);a.useEffect(()=>{x(),D(),B()},[]),a.useEffect(()=>{const t=f.filter(r=>r.name.toLowerCase().includes(n.toLowerCase()));z(t),n&&t.length===0&&i({open:!0,message:"No products found for the search term.",type:"warning"})},[f,n]);const R=t=>{E(t),b(t.stock),l(!0)},_=async()=>{S(!0);try{await k(A.id,parseInt(j)),i({open:!0,message:"Stock updated",type:"success"}),l(!1),x()}catch{i({open:!0,message:"Update failed",type:"error"})}finally{S(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(W,{title:"Update Stock",items:$}),e.jsx(P,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2,mt:1,children:e.jsx(v,{label:"Search by Name",value:n,onChange:t=>U(t.target.value),size:"small",sx:{width:300}})}),e.jsxs(F,{variant:"outlined",children:[e.jsxs(Q,{children:[e.jsx(q,{children:e.jsxs(y,{sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(s,{children:"Name"}),e.jsx(s,{children:"Category"}),e.jsx(s,{children:"Brand"}),e.jsx(s,{children:"Price"}),e.jsx(s,{children:"Stock"}),e.jsx(s,{children:"Status"}),e.jsx(s,{children:"Action"})]})}),e.jsx(G,{children:g.slice(m*d,m*d+d).map(t=>{const r=T.find(u=>u.id===t.brand_id),p=w.find(u=>u.id===t.category_id);return e.jsxs(y,{children:[e.jsx(s,{children:t.name}),e.jsx(s,{children:(p==null?void 0:p.name)||"-"}),e.jsx(s,{children:(r==null?void 0:r.name)||"-"}),e.jsx(s,{children:t.price}),e.jsx(s,{children:t.stock}),e.jsx(s,{children:e.jsx(J,{label:t.is_active?"Active":"Disabled",color:t.is_active?"success":"default",size:"small"})}),e.jsx(s,{children:e.jsx(h,{variant:"outlined",size:"small",onClick:()=>R(t),children:"Update"})})]},t.id)})})]}),e.jsx(K,{component:"div",count:g.length,page:m,rowsPerPage:d,rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],onPageChange:(t,r)=>C(r),onRowsPerPageChange:t=>{N(parseInt(t.target.value,10)),C(0)}})]}),e.jsxs(M,{open:I,onClose:()=>!c&&l(!1),fullWidth:!0,maxWidth:"xs",children:[e.jsx(X,{children:"Update Stock"}),e.jsx(V,{children:e.jsx(P,{mt:1,children:e.jsx(v,{label:"Stock Quantity",fullWidth:!0,type:"number",value:j,onChange:t=>b(t.target.value)})})}),e.jsxs(Y,{children:[e.jsx(h,{onClick:()=>l(!1),disabled:c,children:"Cancel"}),e.jsx(h,{onClick:_,variant:"contained",disabled:c,children:c?e.jsx(Z,{size:24}):"Save"})]})]}),e.jsx(H,{open:o.open,autoHideDuration:3e3,onClose:()=>i({...o,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(O,{severity:o.type,onClose:()=>i({...o,open:!1}),variant:"filled",children:o.message})})]})};export{Re as default};
