import{r as m,j as e,C,S as y}from"./index-6881a38b.js";import{B as v}from"./Breadcrumb-463c378a.js";import{u as B,c as S,a as h,d as k}from"./array-502ce756.js";import{u as w}from"./useCategory-d265f006.js";import{B as f,T as g}from"./Box-d449a0b0.js";import{G as i}from"./Grid-132cce37.js";import{T as x}from"./TextField-7f727abd.js";import{B as u}from"./Button-ff562e0b.js";import"./index.esm-522351cb.js";import"./Link-585f2144.js";import"./_baseIsEqual-f6d5b41e.js";import"./FormControl-8f5e2d3c.js";import"./utils-a73c94d0.js";import"./useFormControl-d4f0b139.js";import"./isMuiElement-4897e4b7.js";import"./useId-c7e897e5.js";import"./formControlState-a1fb9590.js";import"./Select-d12d8e0d.js";import"./Popover-40bbd40c.js";import"./Modal-04cf2a2a.js";import"./Fade-577ca4d2.js";import"./ownerWindow-71250041.js";import"./createChainedFunction-0bab83cf.js";import"./Portal-343632f1.js";import"./List-9cc45e96.js";import"./useControlled-4f8eaaf0.js";const F=[{to:"/",title:"Home"},{to:"/allCategories",title:"Categories"},{title:"Add Category"}],ee=()=>{const{addCategory:b}=w(),[p,d]=m.useState(null),o=m.useRef(null),[c,l]=m.useState({open:!1,message:""}),r=B({initialValues:{name:"",description:"",file:null},validationSchema:S({name:h().required("Name is required"),description:h().required("Description is required"),file:k().required("Image is required")}),onSubmit:async(a,{resetForm:s})=>{try{const n=new FormData;n.append("name",a.name),n.append("description",a.description),n.append("file",a.file);const t=await b(n);t!=null&&t.status?(l({open:!0,message:"Category added successfully"}),s(),d(null),o.current&&(o.current.value="")):l({open:!0,message:(t==null?void 0:t.error)||"Failed to add category"})}catch{l({open:!0,message:"Error while adding category"})}}}),j=a=>{const s=a.currentTarget.files[0];s&&(r.setFieldValue("file",s),d(URL.createObjectURL(s)))};return e.jsxs(f,{children:[e.jsx(v,{title:"Add Category",items:F}),e.jsxs(C,{sx:{mt:2,p:3},elevation:3,children:[e.jsx(g,{variant:"h6",gutterBottom:!0,children:"Create New Category"}),e.jsx("form",{onSubmit:r.handleSubmit,children:e.jsxs(i,{container:!0,spacing:2,children:[e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,label:"Category Name",name:"name",value:r.values.name,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.name&&!!r.errors.name,helperText:r.touched.name&&r.errors.name})}),e.jsx(i,{item:!0,xs:12,sm:6,children:e.jsx(x,{fullWidth:!0,label:"Description",name:"description",value:r.values.description,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.description&&!!r.errors.description,helperText:r.touched.description&&r.errors.description})}),p&&e.jsx(i,{item:!0,xs:12,children:e.jsxs(f,{mt:1,position:"relative",display:"inline-block",children:[e.jsx("img",{src:p,alt:"Preview",style:{width:100,height:100,objectFit:"cover",borderRadius:8,border:"1px solid #ccc"}}),e.jsx(u,{size:"small",onClick:()=>{d(null),r.setFieldValue("file",null),o.current&&(o.current.value="")},sx:{minWidth:0,padding:0,position:"absolute",top:-8,right:-8,backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"50%",lineHeight:1,zIndex:2},children:"âœ•"})]})}),e.jsxs(i,{item:!0,xs:12,children:[e.jsxs(u,{variant:"outlined",component:"label",sx:{":hover":{backgroundColor:"#b9b9b9ff",borderColor:"#b9b9b9ff"}},children:["Upload Image",e.jsx("input",{ref:o,hidden:!0,accept:"image/*",type:"file",onChange:j})]}),r.touched.file&&r.errors.file&&e.jsx(g,{color:"error",variant:"body2",children:r.errors.file})]}),e.jsx(i,{item:!0,xs:12,children:e.jsx(u,{type:"submit",variant:"contained",color:"primary",children:"Submit"})})]})}),e.jsx(y,{open:c.open,autoHideDuration:3e3,onClose:()=>l({...c,open:!1}),message:c.message,anchorOrigin:{vertical:"bottom",horizontal:"right"}})]})]})};export{ee as default};
