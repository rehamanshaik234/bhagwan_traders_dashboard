import{r as t,m as oe,u as de,j as e,C as ce,S as me,D as xe,v as he,I as B}from"./index-6881a38b.js";import{d as L,a as V,b as U,c as q}from"./LastPage-50f3a6a1.js";import{B as ue}from"./Breadcrumb-463c378a.js";import{u as je}from"./useInventory-26d185b2.js";import{B as r,T as c}from"./Box-d449a0b0.js";import{T as G,I as f}from"./TextField-7f727abd.js";import{F as v}from"./FormControl-8f5e2d3c.js";import{S as y}from"./Select-d12d8e0d.js";import{M as o}from"./MenuItem-0a5cd614.js";import{B as g}from"./Button-ff562e0b.js";import{T as ge}from"./TableContainer-0ad4f5c4.js";import{T as pe,a as be,b as M,c as m,d as fe}from"./TableRow-d0664d59.js";import{C as J}from"./Chip-800657f9.js";import{T as ve}from"./TableFooter-169d4b91.js";import{T as ye}from"./TablePagination-5840844c.js";import{D as K,a as Q}from"./DialogContent-f1adb223.js";import{D as X}from"./DialogTitle-7dff730c.js";import{D as Y}from"./DialogActions-bbf09e0d.js";import{C as Ce}from"./CircularProgress-8429f72f.js";import"./createSvgIcon-e0680651.js";import"./createChainedFunction-0bab83cf.js";import"./ownerWindow-71250041.js";import"./isMuiElement-4897e4b7.js";import"./useId-c7e897e5.js";import"./useControlled-4f8eaaf0.js";import"./index.esm-522351cb.js";import"./Grid-132cce37.js";import"./Link-585f2144.js";import"./formControlState-a1fb9590.js";import"./useFormControl-d4f0b139.js";import"./utils-a73c94d0.js";import"./Popover-40bbd40c.js";import"./Modal-04cf2a2a.js";import"./Fade-577ca4d2.js";import"./Portal-343632f1.js";import"./List-9cc45e96.js";import"./listItemTextClasses-0a907018.js";import"./dividerClasses-f2209139.js";import"./KeyboardArrowRight-b6f9714b.js";import"./Toolbar-f3beb080.js";function _e({count:u,page:d,rowsPerPage:C,onPageChange:j}){const x=he();return e.jsxs(r,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(B,{onClick:n=>j(n,0),disabled:d===0,children:x.direction==="rtl"?e.jsx(L,{}):e.jsx(V,{})}),e.jsx(B,{onClick:n=>j(n,d-1),disabled:d===0,children:x.direction==="rtl"?e.jsx(U,{}):e.jsx(q,{})}),e.jsx(B,{onClick:n=>j(n,d+1),disabled:d>=Math.ceil(u/C)-1,children:x.direction==="rtl"?e.jsx(q,{}):e.jsx(U,{})}),e.jsx(B,{onClick:n=>j(n,Math.max(0,Math.ceil(u/C)-1)),disabled:d>=Math.ceil(u/C)-1,children:x.direction==="rtl"?e.jsx(V,{}):e.jsx(L,{})})]})}const Se=[{to:"/",title:"Home"},{title:"Manage Products"}],ma=()=>{var R,P,$,H,N;const{getProducts:u,products:d,loading:C,getCategories:j,categories:x,addOrEditProduct:n,getBrands:Z,brands:F}=je(),[s,_]=t.useState({brand_id:"",category_id:"",name:"",is_active:""}),[w,z]=t.useState(0),[I,ee]=t.useState(5),[ae,S]=t.useState(!1),[p,ie]=t.useState(null),[h,k]=t.useState({name:"",description:"",price:"",stock:"",brand_id:"",category_id:""}),[T,E]=t.useState(!1),[b,D]=t.useState({open:!1,type:"success",message:""}),[i,A]=t.useState(null),{meta:se}=oe(a=>a.inventory),te=de();t.useEffect(()=>{j(),Z()},[]),t.useEffect(()=>{O()},[s,w,I]);const O=()=>{const a=Object.fromEntries(Object.entries(s).filter(([l,W])=>W!==""));u({...a,page:w+1,limit:I,sort:"p.created_at",order:"desc"})},re=a=>{ie(a),k({name:a.name,description:a.description,price:a.price,stock:a.stock,brand_id:a.brand_id,category_id:a.category_id}),S(!0)},le=a=>{A(a)},ne=async()=>{E(!0);try{await n(p==null?void 0:p.id,h),D({open:!0,type:"success",message:p?"Product updated!":"Product added!"}),S(!1),u(s),O()}catch(a){D({open:!0,type:"error",message:a.message})}finally{E(!1)}};return e.jsxs(e.Fragment,{children:[e.jsx(ue,{title:"Manage Products",items:Se}),e.jsxs(r,{display:"flex",justifyContent:"space-between",flexWrap:"wrap",children:[e.jsxs(r,{display:"flex",flexWrap:"wrap",gap:2,mb:2,children:[e.jsx(G,{label:"Name",value:s.name,onChange:a=>_({...s,name:a.target.value}),size:"small"}),e.jsxs(v,{sx:{minWidth:200},variant:"outlined",size:"small",children:[e.jsx(f,{id:"brand-label",children:"Brand"}),e.jsxs(y,{labelId:"brand-label",value:s.brand_id,label:"Brand",onChange:a=>_({...s,brand_id:a.target.value}),children:[e.jsx(o,{value:"",children:"All"}),F.map(a=>e.jsx(o,{value:a.id,children:a.name},a.id))]})]}),e.jsxs(v,{sx:{minWidth:200},variant:"outlined",size:"small",children:[e.jsx(f,{id:"category-label",children:"Category"}),e.jsxs(y,{labelId:"category-label",value:s.category_id,label:"Category",onChange:a=>_({...s,category_id:a.target.value}),children:[e.jsx(o,{value:"",children:"All"}),x.map(a=>e.jsx(o,{value:a.id,children:a.name},a.id))]})]}),e.jsxs(v,{sx:{minWidth:200},variant:"outlined",size:"small",children:[e.jsx(f,{id:"status-label",children:"Status"}),e.jsxs(y,{labelId:"status-label",value:s.is_active,label:"Status",onChange:a=>_({...s,is_active:a.target.value}),children:[e.jsx(o,{value:"",children:"All"}),e.jsx(o,{value:"1",children:"Active"}),e.jsx(o,{value:"0",children:"Disabled"})]})]})]}),e.jsx(r,{mb:2,children:e.jsx(g,{variant:"contained",onClick:()=>te("/addProducts"),children:"Add Product"})})]}),e.jsx(ce,{variant:"outlined",children:e.jsx(ge,{children:e.jsxs(pe,{sx:{minWidth:1e3},children:[e.jsx(be,{children:e.jsx(M,{children:["Image","Name","Category","Price","Stock","Status","Actions"].map(a=>e.jsx(m,{align:"center",sx:{fontWeight:600},children:a},a))})}),e.jsx(fe,{children:d.map(a=>{var l,W;return e.jsxs(M,{children:[e.jsx(m,{align:"center",children:e.jsx("img",{src:((l=a.image_urls)==null?void 0:l[0])||"/no-image.png",alt:a.name,width:40,height:40,style:{borderRadius:4,objectFit:"cover"}})}),e.jsx(m,{align:"center",children:a.name}),e.jsx(m,{align:"center",children:((W=a.category)==null?void 0:W.name)||"-"}),e.jsxs(m,{align:"center",children:["₹",a.price]}),e.jsx(m,{align:"center",children:a.stock}),e.jsx(m,{align:"center",children:e.jsx(J,{label:a.is_active?"Active":"Disabled",color:a.is_active?"success":"default",size:"small"})}),e.jsx(m,{align:"center",children:e.jsxs(r,{display:"flex",gap:1,justifyContent:"center",children:[e.jsx(g,{variant:"outlined",size:"small",onClick:()=>le(a),children:"View"}),e.jsx(g,{variant:"outlined",size:"small",onClick:()=>re(a),children:"Edit"})]})})]},a.id)})}),e.jsx(ve,{children:e.jsx(M,{children:e.jsx(ye,{rowsPerPageOptions:[5,10,25],count:se.total,rowsPerPage:I,page:w,onPageChange:(a,l)=>z(l),onRowsPerPageChange:a=>{ee(parseInt(a.target.value,10)),z(0)},ActionsComponent:_e})})})]})})}),e.jsxs(K,{open:ae,onClose:()=>!T&&S(!1),fullWidth:!0,maxWidth:"sm",children:[e.jsx(X,{children:p?"Edit Product":"Add Product"}),e.jsx(Q,{dividers:!0,children:e.jsxs(r,{display:"flex",flexDirection:"column",gap:2,children:[["name","description","price","stock"].map(a=>e.jsx(G,{label:a.charAt(0).toUpperCase()+a.slice(1),fullWidth:!0,value:h[a],onChange:l=>k({...h,[a]:l.target.value}),type:["price","stock"].includes(a)?"number":"text"},a)),e.jsxs(v,{fullWidth:!0,variant:"outlined",children:[e.jsx(f,{id:"modal-brand-label",children:"Brand"}),e.jsx(y,{labelId:"modal-brand-label",value:h.brand_id,label:"Brand",onChange:a=>k({...h,brand_id:parseInt(a.target.value)}),children:F.map(a=>e.jsx(o,{value:a.id,children:a.name},a.id))})]}),e.jsxs(v,{fullWidth:!0,variant:"outlined",children:[e.jsx(f,{id:"modal-category-label",children:"Category"}),e.jsx(y,{labelId:"modal-category-label",value:h.category_id,label:"Category",onChange:a=>k({...h,category_id:a.target.value}),children:x.map(a=>e.jsx(o,{value:a.id,children:a.name},a.id))})]})]})}),e.jsxs(Y,{children:[e.jsx(g,{onClick:()=>S(!1),disabled:T,children:"Cancel"}),e.jsx(g,{onClick:ne,disabled:T,variant:"contained",children:T?e.jsx(Ce,{size:24}):"Save"})]})]}),e.jsxs(K,{open:!!i,onClose:()=>A(null),maxWidth:"md",fullWidth:!0,children:[e.jsx(X,{sx:{fontWeight:"bold",pb:0},children:"Product Details"}),e.jsxs(Q,{dividers:!0,sx:{pt:2},children:[e.jsxs(r,{display:"flex",flexDirection:{xs:"column",md:"row"},gap:4,children:[e.jsx(r,{children:e.jsx("img",{src:((R=i==null?void 0:i.image_urls)==null?void 0:R[0])||"/no-image.png",alt:"Main",width:180,height:180,style:{borderRadius:12,objectFit:"cover",border:"1px solid #ddd"}})}),e.jsxs(r,{flex:1,children:[e.jsx(c,{variant:"h6",gutterBottom:!0,children:i==null?void 0:i.name}),e.jsx(c,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:i==null?void 0:i.description}),e.jsxs(r,{display:"flex",flexWrap:"wrap",gap:2,children:[e.jsxs(c,{children:[e.jsx("strong",{children:"Price:"})," ₹",i==null?void 0:i.price]}),e.jsxs(c,{children:[e.jsx("strong",{children:"Stock:"})," ",i==null?void 0:i.stock]}),e.jsxs(c,{children:[e.jsx("strong",{children:"Category:"})," ",(P=i==null?void 0:i.category)==null?void 0:P.name]}),e.jsxs(c,{children:[e.jsx("strong",{children:"Sub-Category:"})," ",($=i==null?void 0:i.sub_category)==null?void 0:$.name]}),e.jsxs(c,{children:[e.jsx("strong",{children:"Status:"})," ",e.jsx(J,{size:"small",label:i!=null&&i.is_active?"Active":"Disabled",color:i!=null&&i.is_active?"success":"default"})]})]})]})]}),((H=i==null?void 0:i.image_urls)==null?void 0:H.length)>1&&e.jsxs(e.Fragment,{children:[e.jsx(c,{mt:3,mb:1,variant:"subtitle1",children:"More Images"}),e.jsx(r,{display:"flex",gap:2,flexWrap:"wrap",children:(N=i==null?void 0:i.image_urls)==null?void 0:N.slice(1).map((a,l)=>e.jsx("img",{src:a,alt:`Product ${l}`,width:80,height:80,style:{objectFit:"cover",borderRadius:8,border:"1px solid #ccc"}},l))})]})]}),e.jsx(Y,{children:e.jsx(g,{onClick:()=>A(null),children:"Close"})})]}),e.jsx(me,{open:b.open,autoHideDuration:3e3,onClose:()=>D({...b,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(xe,{severity:b.type,onClose:()=>D({...b,open:!1}),variant:"filled",children:b.message})})]})};export{ma as default};
