import{r as n,Y as v,j as r,C as P,S as F}from"./index-6881a38b.js";import{u as R,c as q,a as f,b as S}from"./array-502ce756.js";import{B as T}from"./Breadcrumb-463c378a.js";import{B as x,T as _}from"./Box-d449a0b0.js";import{G as o}from"./Grid-132cce37.js";import{T as u}from"./TextField-7f727abd.js";import{A}from"./Autocomplete-4a848a23.js";import{A as B}from"./Avatar-963f1f93.js";import{B as b}from"./Button-ff562e0b.js";import"./_baseIsEqual-f6d5b41e.js";import"./index.esm-522351cb.js";import"./Link-585f2144.js";import"./FormControl-8f5e2d3c.js";import"./utils-a73c94d0.js";import"./useFormControl-d4f0b139.js";import"./isMuiElement-4897e4b7.js";import"./useId-c7e897e5.js";import"./formControlState-a1fb9590.js";import"./Select-d12d8e0d.js";import"./Popover-40bbd40c.js";import"./Modal-04cf2a2a.js";import"./Fade-577ca4d2.js";import"./ownerWindow-71250041.js";import"./createChainedFunction-0bab83cf.js";import"./Portal-343632f1.js";import"./List-9cc45e96.js";import"./useControlled-4f8eaaf0.js";import"./Popper-aa3de15e.js";import"./ListSubheader-742fb7a6.js";import"./usePreviousProps-73c1b2c1.js";import"./Chip-800657f9.js";const E=[{to:"/",title:"Home"},{to:"/manageProducts",title:"Product"},{title:"Add Product"}],me=()=>{const[k,w]=n.useState([]),[j,y]=n.useState([]),[m,c]=n.useState({open:!1,message:""}),[p,h]=n.useState([]),g=n.useRef(null),C=k.map(i=>{var t;return{...i,group:((t=i.category)==null?void 0:t.name)||"Uncategorized"}});n.useEffect(()=>{(async()=>{var t;try{const s=await v.get("/subcategories/allSubCategories");(t=s.data)!=null&&t.status&&w(s.data.data||[])}catch{c({open:!0,message:"Failed to load sub-categories"})}})()},[]);const e=R({initialValues:{name:"",description:"",price:"",stock:"",sub_category_id:""},validationSchema:q({name:f().required("Required"),description:f().required("Required"),price:S().required("Required").min(0),stock:S().required("Required").min(0),sub_category_id:f().required("Required")}),onSubmit:async(i,{resetForm:t})=>{try{const s=new FormData;Object.keys(i).forEach(a=>{a==="files"?i.files.forEach(l=>s.append("files",l)):s.append(a,i[a])}),(await v.post("/products/addProduct",s,{headers:{"Content-Type":"multipart/form-data"}})).data.status?(c({open:!0,message:"Product added successfully"}),t(),h([]),g.current&&(g.current.value="")):c({open:!0,message:"Failed to add product"})}catch{c({open:!0,message:'"Error while adding product"'})}}});return r.jsxs(x,{children:[r.jsx(T,{title:"Add Product",items:E}),r.jsxs(P,{elevation:3,sx:{mt:2,p:3},children:[r.jsx(_,{variant:"h6",mb:3,children:"Add New Product"}),r.jsx("form",{onSubmit:e.handleSubmit,children:r.jsxs(o,{container:!0,spacing:3,children:[r.jsx(o,{item:!0,xs:12,sm:6,children:r.jsx(u,{label:"Product Name",name:"name",fullWidth:!0,value:e.values.name,onChange:e.handleChange,error:e.touched.name&&!!e.errors.name,helperText:e.touched.name&&e.errors.name})}),r.jsx(o,{item:!0,xs:12,sm:6,children:r.jsx(u,{label:"Price",name:"price",type:"number",fullWidth:!0,value:e.values.price,onChange:e.handleChange,error:e.touched.price&&!!e.errors.price,helperText:e.touched.price&&e.errors.price})}),r.jsx(o,{item:!0,xs:12,sm:6,children:r.jsx(u,{label:"Stock",name:"stock",type:"number",fullWidth:!0,value:e.values.stock,onChange:e.handleChange,error:e.touched.stock&&!!e.errors.stock,helperText:e.touched.stock&&e.errors.stock})}),r.jsx(o,{item:!0,xs:12,sm:6,children:r.jsx(A,{options:C,groupBy:i=>i.group,getOptionLabel:i=>i.name,value:C.find(i=>i.id===e.values.sub_category_id)||null,onChange:(i,t)=>e.setFieldValue("sub_category_id",(t==null?void 0:t.id)||""),renderInput:i=>r.jsx(u,{...i,label:"Sub-Category",fullWidth:!0,error:e.touched.sub_category_id&&!!e.errors.sub_category_id,helperText:e.touched.sub_category_id&&e.errors.sub_category_id}),renderOption:(i,t)=>n.createElement("li",{...i,key:t.id},r.jsx(B,{src:t.image_url,alt:t.name,sx:{width:30,height:30,mr:1}}),r.jsx(_,{variant:"body2",children:t.name})),isOptionEqualToValue:(i,t)=>i.id===t.id})}),r.jsx(o,{item:!0,xs:12,children:r.jsx(u,{label:"Description",name:"description",multiline:!0,rows:4,fullWidth:!0,value:e.values.description,onChange:e.handleChange,error:e.touched.description&&!!e.errors.description,helperText:e.touched.description&&e.errors.description})}),r.jsx(o,{item:!0,xs:12,children:r.jsx(x,{display:"flex",flexWrap:"wrap",gap:2,children:p.map((i,t)=>r.jsxs(x,{position:"relative",display:"inline-block",children:[r.jsx("img",{src:i,alt:`Preview ${t}`,style:{width:80,height:80,objectFit:"cover",borderRadius:8,border:"1px solid #ccc"}}),r.jsx(b,{size:"small",onClick:()=>{const s=p.filter((a,l)=>l!==t),d=j.filter((a,l)=>l!==t);h(s),y(d),e.setFieldValue("files",d)},sx:{minWidth:0,padding:0,position:"absolute",top:-8,right:-8,backgroundColor:"#fff",border:"1px solid #ccc",borderRadius:"50%",zIndex:2,lineHeight:1},children:"âœ•"})]},t))})}),r.jsx(o,{item:!0,xs:12,children:r.jsxs(b,{variant:"outlined",component:"label",children:["Upload Product Images",r.jsx("input",{ref:g,hidden:!0,multiple:!0,accept:"image/*",type:"file",name:"files",onChange:i=>{const t=Array.from(i.target.files),s=[...j,...t],d=[...p,...t.map(a=>URL.createObjectURL(a))];y(s),h(d),e.setFieldValue("files",s)}})]})}),r.jsx(o,{item:!0,xs:12,children:r.jsx(b,{type:"submit",variant:"contained",children:"Submit Product"})})]})})]}),r.jsx(F,{open:m.open,autoHideDuration:3e3,onClose:()=>c({...m,open:!1}),message:m.message,anchorOrigin:{vertical:"bottom",horizontal:"right"}})]})};export{me as default};
