import{n as _,m as B,r as x,Q as I,j as e,u as $,C as S,v as w,I as f}from"./index-6881a38b.js";import{d as y,a as O,b as A,c as k}from"./LastPage-50f3a6a1.js";import{B as N}from"./Breadcrumb-463c378a.js";import{u as F}from"./useOrderDetails-d1cb5a60.js";import{D as M,a as R}from"./DialogContent-f1adb223.js";import{D as z}from"./DialogTitle-7dff730c.js";import{B as h,T as c}from"./Box-d449a0b0.js";import{A as L}from"./Avatar-963f1f93.js";import{D as E}from"./Divider-2303db12.js";import{T as H,a as T}from"./Tabs-043eae2c.js";import{T as Q}from"./TableContainer-0ad4f5c4.js";import{C as q}from"./CircularProgress-8429f72f.js";import{T as J,a as W,b,c as a,d as U}from"./TableRow-d0664d59.js";import{C as V}from"./Chip-800657f9.js";import{B as Z}from"./Button-ff562e0b.js";import{T as G}from"./TableFooter-169d4b91.js";import{T as K}from"./TablePagination-5840844c.js";import"./createSvgIcon-e0680651.js";import"./createChainedFunction-0bab83cf.js";import"./ownerWindow-71250041.js";import"./isMuiElement-4897e4b7.js";import"./useId-c7e897e5.js";import"./useControlled-4f8eaaf0.js";import"./index.esm-522351cb.js";import"./Grid-132cce37.js";import"./Link-585f2144.js";import"./Modal-04cf2a2a.js";import"./Fade-577ca4d2.js";import"./Portal-343632f1.js";import"./dividerClasses-f2209139.js";import"./KeyboardArrowRight-b6f9714b.js";import"./Toolbar-f3beb080.js";import"./Select-d12d8e0d.js";import"./Popover-40bbd40c.js";import"./List-9cc45e96.js";import"./utils-a73c94d0.js";import"./formControlState-a1fb9590.js";import"./useFormControl-d4f0b139.js";import"./MenuItem-0a5cd614.js";import"./listItemTextClasses-0a907018.js";const X=()=>{const s=_(),{allOrders:l,loading:o,error:n}=B(i=>i.orders);return x.useEffect(()=>{s(I())},[s]),{orders:l,loading:o,error:n}},Y=({open:s,onClose:l,order:o})=>{var j;if(!o)return null;const{latitude:n,longitude:i,address:t,customer:m,order_items:u,total_amount:p,status:D,id:C}=o,d=(j=u==null?void 0:u[0])==null?void 0:j.product,v=`https://www.google.com/maps/embed/v1/directions?key=AIzaSyAgJaHy0QbjM9qZfn3NtDvdJQh4u6StR5s&origin=${n},${i}&destination=${t.latitude},${t.longitude}&mode=driving`;return e.jsxs(M,{open:s,onClose:l,fullWidth:!0,maxWidth:"md",children:[e.jsxs(z,{children:["Order #",C," Tracking"]}),e.jsxs(R,{children:[e.jsxs(h,{mb:2,children:[e.jsxs(c,{variant:"subtitle1",children:[e.jsx("strong",{children:"Status:"})," ",D]}),e.jsxs(c,{variant:"subtitle1",children:[e.jsx("strong",{children:"Customer Number:"})," ",m==null?void 0:m.number]}),e.jsxs(c,{variant:"subtitle1",children:[e.jsx("strong",{children:"Delivery Address:"})," ",t==null?void 0:t.building_name,", ",t==null?void 0:t.address_line,", ",t==null?void 0:t.city,", ",t==null?void 0:t.state," - ",t==null?void 0:t.postal_code]}),e.jsxs(c,{variant:"subtitle1",children:[e.jsx("strong",{children:"Total Amount:"})," ₹",p]}),d&&e.jsxs(h,{mt:2,display:"flex",alignItems:"center",gap:2,children:[e.jsx(L,{src:d.image_url,alt:d.name,variant:"rounded",sx:{width:64,height:64}}),e.jsx(c,{variant:"subtitle1",children:d.name})]})]}),e.jsx(E,{sx:{my:2}}),e.jsx("iframe",{title:"Order Route",width:"100%",height:"400",style:{border:0},loading:"lazy",allowFullScreen:!0,src:v})]})]})},ee=[{to:"/",title:"Home"},{title:"Dispatched Orders"}],te=s=>{switch(s){case"Dispatched":return"primary";case"Picked":return"info";case"OutForDelivery":return"warning";case"Delivered":return"success";case"Cancelled":return"error";default:return"default"}},re=({count:s,page:l,rowsPerPage:o,onPageChange:n})=>{const i=w();return e.jsxs(h,{sx:{flexShrink:0,ml:2.5},children:[e.jsx(f,{onClick:t=>n(t,0),disabled:l===0,children:i.direction==="rtl"?e.jsx(y,{}):e.jsx(O,{})}),e.jsx(f,{onClick:t=>n(t,l-1),disabled:l===0,children:i.direction==="rtl"?e.jsx(A,{}):e.jsx(k,{})}),e.jsx(f,{onClick:t=>n(t,l+1),disabled:l>=Math.ceil(s/o)-1,children:i.direction==="rtl"?e.jsx(k,{}):e.jsx(A,{})}),e.jsx(f,{onClick:t=>n(t,Math.max(0,Math.ceil(s/o)-1)),disabled:l>=Math.ceil(s/o)-1,children:i.direction==="rtl"?e.jsx(O,{}):e.jsx(y,{})})]})},Qe=()=>{const[s,l]=x.useState("dispatched"),[o,n]=x.useState(0),[i,t]=x.useState(5),{orders:m,loading:u,error:p}=X(),{orderDetail:D,requestDetails:C}=F(),[d,v]=x.useState(!1),j=$(),g=m.filter(r=>r.status.toLowerCase()===s);return e.jsxs(e.Fragment,{children:[e.jsx(N,{title:"Dispatched Orders",items:ee}),e.jsx(S,{sx:{mb:2},children:e.jsxs(H,{value:s,onChange:(r,P)=>l(P),centered:!0,children:[e.jsx(T,{label:"Dispatched",value:"dispatched"}),e.jsx(T,{label:"Picked",value:"picked"}),e.jsx(T,{label:"Out For Delivery",value:"outfordelivery"})]})}),e.jsx(S,{variant:"outlined",children:e.jsx(Q,{children:u?e.jsxs(h,{p:5,textAlign:"center",children:[e.jsx(q,{}),e.jsx(c,{mt:2,children:"Loading orders..."})]}):p?e.jsx(h,{p:5,textAlign:"center",children:e.jsx(c,{color:"error",children:p})}):e.jsxs(J,{children:[e.jsx(W,{children:e.jsxs(b,{sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(a,{children:"Order ID"}),e.jsx(a,{children:"Customer ID"}),e.jsx(a,{children:"Status"}),e.jsx(a,{children:"Total Amount"}),e.jsx(a,{children:"Created At"}),e.jsx(a,{children:"Action"})]})}),e.jsxs(U,{children:[(i>0?g.slice(o*i,o*i+i):g).map(r=>e.jsxs(b,{children:[e.jsx(a,{children:r.id}),e.jsx(a,{children:r.customer_id}),e.jsx(a,{children:e.jsx(V,{label:r.status,color:te(r.status),size:"small"})}),e.jsxs(a,{children:["₹",r.total_amount]}),e.jsxs(a,{children:[new Date(r.created_at).toLocaleDateString("en-IN"),e.jsx("br",{}),new Date(r.created_at).toLocaleTimeString("en-IN")]}),e.jsx(a,{children:e.jsx(Z,{onClick:()=>j(`/order/${r.id}`,{state:{order:r}}),size:"small",variant:"outlined",children:"View"})})]},r.id)),g.length===0&&e.jsx(b,{children:e.jsxs(a,{colSpan:6,align:"center",children:["No orders found for ",e.jsx("strong",{children:s})," status."]})})]}),e.jsx(G,{children:e.jsx(b,{children:e.jsx(K,{rowsPerPageOptions:[5,10,25,{label:"All",value:-1}],colSpan:6,count:g.length,rowsPerPage:i,page:o,SelectProps:{inputProps:{"aria-label":"rows per page"},native:!0},onPageChange:n,onRowsPerPageChange:r=>{t(parseInt(r.target.value,10)),n(0)},ActionsComponent:re})})})]})})}),e.jsx(Y,{open:d,onClose:()=>v(!1),order:D})]})};export{Qe as default};
